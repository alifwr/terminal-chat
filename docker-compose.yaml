services:
  assistant-ui:
    build: ./assistant-ui
    container_name: pentesting-assist-ui
    ports:
      - "3000:3000"
    restart: unless-stopped
    networks:
      - kali_network
  
  terminal-mcp:
    build: ./terminal-mcp
    container_name: pentesting-assist-terminal
    ports:
      - "9020:8080"
      - "9021:5900"
      - "8000:8000"
      - "8080:8090"
    restart: unless-stopped
    volumes:
      - /etc/localtime:/etc/localtime:ro
    environment:
      - NODE_ENV=production
    privileged: true
    stdin_open: true
    tty: true
    networks:
      - kali_network

  targets-manager:
    build: ./targets-manager
    container_name: pentesting-assist-targets-manager
    ports:
      - "8025:8000"
    volumes:
      # Mount the benchmarks directory
      - ./targets-manager/app/benchmarks:/app/app/benchmarks
      # Mount Docker socket to allow container to control Docker on host
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - PYTHONPATH=/app
    restart: unless-stopped
    networks:
      - kali_network
    
networks:
  kali_network:
    driver: bridge